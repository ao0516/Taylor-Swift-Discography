---
title: "Taylor Swift"
output: html_document
date: "2024-01-25"
---


```{r setup, include = FALSE}

library(tidyverse)
library(taylor)

knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```


## Example

There are three main data sets. The first is `taylor_album_songs`, which includes lyrics and audio features from the Spotify API for all songs on Taylor's official studio albums. Notably this excludes singles released separately from an album (e.g., *Only the Young*, *Christmas Tree Farm*, etc.), and non-Taylor-owned albums that have a Taylor-owned alternative (e.g., *Fearless* is excluded in favor of *Fearless (Taylor's Version)*). We stan artists owning their own songs.

```{r album-songs}
taylor_albulm_songs <- taylor_album_songs
```

You can access Taylor's entire discography with `taylor_all_songs`. This includes all of the songs in `taylor_album_songs` plus EPs, individual singles, and the original versions of albums that have been re-released as *Taylor's Version*.

```{r all-songs}
taylor_all_songs <- taylor_all_songs
```

Finally, there is a small data set, `taylor_albums`, summarizing Taylor's album release history.

```{r albums}
taylor_albums <- taylor_albums
```

```{r}

# Set up Spotify API access
client_id <- 'b5af36ff5bf1490b8e41060102108c5d'
client_secret <- '8b58d77e04024dfb92b775a989872556'

token <- httr::POST(
  url = "https://accounts.spotify.com/api/token",
  body = list(grant_type = "client_credentials"),
  authenticate(client_id, client_secret),
  encode = "form"
) |> httr::content("parsed")

artist_id = '06HL4z0CvFAxyc27GXpf02'  # Taylor Swift's Spotify artist ID



```

```{r}
# Install and load required packages
library(httr)
library(dplyr)


# Set up Spotify API access
client_id <- 'b5af36ff5bf1490b8e41060102108c5d'
client_secret <- '8b58d77e04024dfb92b775a989872556'

# Authenticate with Spotify API
token <- httr::POST(
  url = "https://accounts.spotify.com/api/token",
  body = list(
    grant_type = "client_credentials"
  ),
  authenticate(client_id, client_secret),
  encode = "form"
) |> httr::content("parsed")

# Get Taylor Swift's discography
artist_id <- '06HL4z0CvFAxyc27GXpf02'  # Taylor Swift's Spotify artist ID

albums <- httr::GET(
  url = paste0("https://api.spotify.com/v1/artists/", artist_id, "/albums"),
  add_headers(Authorization = paste0("Bearer ", token$access_token))
) |> httr::content("parsed")

# Extract track IDs
track_ids <- sapply(albums$items, function(album) album$uri)

# Get audio features for each track
audio_features <- lapply(track_ids, function(track_id) {
  httr::GET(
    url = paste0("https://api.spotify.com/v1/audio-features/", URLencode(track_id)),
    add_headers(Authorization = paste0("Bearer ", token$access_token))
  ) |> httr::content("parsed")
})

# Extract popularity scores
popularity_scores <- sapply(audio_features, function(features) features$popularity)

# Create a data frame
TS_popscore <- data.frame(TrackID = track_ids, PopularityScore = popularity_scores)

# Save the data frame to a CSV file
write.csv(TS_popscore, 'taylor_swift_popularity_scores.csv', row.names = FALSE)

```


```{r}

# Manually input the data for the new column
new_data <- c("120681144", "177476212", "201819648","38006696", "393555192", "27152957","30582153", "32159952", "111944757","41444442", "307657056", "46882871","32245922", "23516670", "30572544","114156809", "112324751", "839744760","48099348", "107857315", "607923068","67075537", "30676668", "45283757","68235800", "52528575", "38744030","26360809", "24913357", "22122687","26726100", "16360926", "13485429","14594796", "242744567", "90429706","642874800", "80554113", "85751097","554449538", "60331549", "51745577","64918203", "372522117", "99531508","47007427", "40393013", "50309638","50849541", "46847438", "36709406","33064626", "63990782", "47992191","104232029", "338943982", "54201297","71648351", "64098942", "50410737","216622266", "176533939", "375695596","140422062", "138694598", "222507257","149240409", "83127466", "755265586","185784783", "51036807", "100252218","120077288", "97483745", "70337971","42824112", "25172244", "137598364","96288640", "154712290", "84439221","86658091", "78879153", "77593542","46524427", "210044452", "102713874","39370922", "62365463", "62246155","96599305", "44063949", "33190443","70412269", "67928411", "209477724","69169962", "73751551", "68510110","60185233", "246645932", "54474537","784032106", "241173542", "372594988","61283829", "640769212", "56534725","65603684", "53575303", "39204272","43261910", "267564922", "42901025","123730013", "31632535", "41752633","22737389", "16410445", "17361810","23578304", "112739959", "255300904","100677120", "296807428", "233770103","236644107", "83996319", "281840712","81319480", "100640319", "77891461","86945215", "70397598", "132932137","54026514", "91309204", "64540303","100182544", "53340003", "47957284","39802175", "129923150", "195924465","109649205", "175985002", "194926834","84654003", "129930225", "155705618","756279728", "239916921", "1708424142","1126140383", "315910730", "215419525","1314935590", "149014116", "567280513","911638013", "165093811", "105668885","131308107", "190696276", "145464422","138988778", "268717421", "79944241","111645621", "135303977", "92164969","69901392", "75220894", "61153405","58289749", "637705307", "52435052","218504402", "54175738", "67558793","53249147", "53636077", "80990224","182041125", "131080271", "192284098","82161697", "278728794", "44568311","0", "641217600", "462393157","403266217", "974677460", "905588449","1065314038", "164867171", "551200809","591307342", "243791713", "227813502","286952177", "202576744", "366811972","177239723", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103", "876", "999","103") 

# Add the new column directly to the existing data frame
taylor_all_songs$Streams <- new_data


```




